{"nbformat":4,"nbformat_minor":0,"metadata":{"accelerator":"TPU","colab":{"name":"Rania","provenance":[{"file_id":"1wK36qm782uaIMn6OkwwV198UQZiW2idd","timestamp":1620064523193},{"file_id":"1QrdbTdSPP-wMCV0fyPKXxXhxCa_gLdJS","timestamp":1619833905522},{"file_id":"1ESReBdCSZ8OEyi6bOFzL_NXeICtih2-s","timestamp":1619704313459},{"file_id":"1a4txxUBmEqjVdeNwz7tT2fcztNCjg-3r","timestamp":1619267674888},{"file_id":"14vA4UpRM8COXlv5RnfjJh8rq77XPIAar","timestamp":1618888573175},{"file_id":"121SV4mqDISwW4ixbEFhyshduglMAOn3H","timestamp":1616542220284},{"file_id":"1RLlPfzcRc4Qrn3frHLLyODqQc9e0nYF3","timestamp":1614513608125},{"file_id":"15Am8wPR-yPJP_fySchFtzaWo8wo116Z7","timestamp":1601512001753},{"file_id":"1TBTsuWzb6vdZl1AV7s16o3j3NKok79Gh","timestamp":1598352229611},{"file_id":"1WOTfZ9mX8atmNO-S-7P19hI3j3S7r5Gi","timestamp":1590019726013},{"file_id":"1gyDITBIpgyWHpuzUzc4G05CT8KQMUrSU","timestamp":1587076395972}],"collapsed_sections":["aTcVvZLxicB_","vCmfgIy9frZR","Mj5OSBQMf4-d","dJ3RvBPQf7fT","0ok-IVZl0xID","dJ_ER9DhCQGj","PIb7HOBxEyVz","00u5IAxw_sev","2Fp-Cbw_e2TW","iCIVAvMVe5eO","OfUSgZhjfI-A","zr_YIvreub21","WsasMBu0ud9R","Wh3F7eOvugt3","yv0oIj3fujmJ","bdt_480Cul5Y","Us8kmV9suo7q","KMtKlGiKkglz","MsvXLipBnrum","FJcrg46fq96M"],"machine_shape":"hm"},"kernelspec":{"display_name":"Python 3","name":"python3"},"widgets":{"application/vnd.jupyter.widget-state+json":{"6fd7c5c9bdbd493ab75fc477e455e294":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_94485c14a62a48b48a9725bde6e203b8","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_ff33bcc99ab04ac69ef249d624f2aeaf","IPY_MODEL_0e2f05543898487e8ac564c3d9144d8e"]}},"94485c14a62a48b48a9725bde6e203b8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ff33bcc99ab04ac69ef249d624f2aeaf":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_d393f190fbea4de497548dcc5cf30994","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":231508,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":231508,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_040abc4e70f34fbf9fc709a98d99f5a4"}},"0e2f05543898487e8ac564c3d9144d8e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_cf40a2effa504d989394a8e049debb97","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 232k/232k [00:00&lt;00:00, 439kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a3911f81c24845f5a6eade2417bbf153"}},"d393f190fbea4de497548dcc5cf30994":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"040abc4e70f34fbf9fc709a98d99f5a4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"cf40a2effa504d989394a8e049debb97":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"a3911f81c24845f5a6eade2417bbf153":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3403afeea4ce44919fc0194612dc0028":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_863a5c9e64864220ac3255903c62bb76","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_b2fd5979c99a417aa55322432eb250e8","IPY_MODEL_54902c4835e545f18463b5209029cd8b"]}},"863a5c9e64864220ac3255903c62bb76":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b2fd5979c99a417aa55322432eb250e8":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_b1852b809c154298b9f9ef6e86f80937","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":28,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":28,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_e41636d453c84ea7ae95faff494218c8"}},"54902c4835e545f18463b5209029cd8b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_359eee31fa3d442cbc54f21e8cbaeaa0","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 28.0/28.0 [00:00&lt;00:00, 67.6B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c4e7c35940dd41679f5b148b02e51a4c"}},"b1852b809c154298b9f9ef6e86f80937":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"e41636d453c84ea7ae95faff494218c8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"359eee31fa3d442cbc54f21e8cbaeaa0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"c4e7c35940dd41679f5b148b02e51a4c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"eaa2ccdfdb5b48ae82b298626615eafd":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_2d9edf4fd3974f4ea3d5bbce9a03ee43","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_4956547b260f4bdfb84e3b0f0ae78b07","IPY_MODEL_4e43753c16cd4c989fe162de23f579fb"]}},"2d9edf4fd3974f4ea3d5bbce9a03ee43":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4956547b260f4bdfb84e3b0f0ae78b07":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_890cc2b1eb0b4b19a7098e2486042e8e","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":466062,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":466062,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c700349663914ed299327e6a12eec1c2"}},"4e43753c16cd4c989fe162de23f579fb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ea87887bad484d60a103a7ce8916f9b3","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 466k/466k [00:00&lt;00:00, 2.69MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_079d0bcbe11240f39a238a2808a20971"}},"890cc2b1eb0b4b19a7098e2486042e8e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"c700349663914ed299327e6a12eec1c2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ea87887bad484d60a103a7ce8916f9b3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"079d0bcbe11240f39a238a2808a20971":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1b770aec90874a88b568809c7863a2d0":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_73ef84f1708c411aac2ae001ee6843fc","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_26f97646300440778c73bce0cb9602f2","IPY_MODEL_bb428e1e67f443f1a44917329ebcee35"]}},"73ef84f1708c411aac2ae001ee6843fc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"26f97646300440778c73bce0cb9602f2":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_0d15895a94a14f46b8131eb5b09e6362","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":570,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":570,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_f017003b15a04fcea81326b2792c6f0b"}},"bb428e1e67f443f1a44917329ebcee35":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_85a80965f0ae4178ae21e7945f83c154","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 570/570 [00:00&lt;00:00, 1.44kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b024a29e44af4c5aad2798c64d8f9645"}},"0d15895a94a14f46b8131eb5b09e6362":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"f017003b15a04fcea81326b2792c6f0b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"85a80965f0ae4178ae21e7945f83c154":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"b024a29e44af4c5aad2798c64d8f9645":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d32cebf9783d43eaa4bc471c2a60684e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_d0c867acfe2348549fe20d3b9b2fd11d","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_602f91d8164c4db4b827c2a772e0b7ac","IPY_MODEL_1590d19477d741169284c6744943f4ea"]}},"d0c867acfe2348549fe20d3b9b2fd11d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"602f91d8164c4db4b827c2a772e0b7ac":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_a65ecef8a5774c368502476f206af885","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":440473133,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":440473133,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_81c045b02d0d4f0d92bbf8cf56b81756"}},"1590d19477d741169284c6744943f4ea":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_16d5cdd9d47145f1ba2668e72ac6606f","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 440M/440M [00:09&lt;00:00, 44.9MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_163ef2ee33f24852b78ac7946991d4a7"}},"a65ecef8a5774c368502476f206af885":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"81c045b02d0d4f0d92bbf8cf56b81756":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"16d5cdd9d47145f1ba2668e72ac6606f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"163ef2ee33f24852b78ac7946991d4a7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"HaA1pmS05YvO"},"source":["##**Installing the transformers library**\n","\n"]},{"cell_type":"code","metadata":{"id":"H8NKlQOUwdC1"},"source":["!pip install transformers"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"2RTRSs0dH-V-"},"source":["##**Importing the tools**"]},{"cell_type":"code","metadata":{"id":"p7WXSnQowxsP"},"source":["\n","import numpy as np\n","import pandas as pd\n","from sklearn.model_selection import train_test_split\n","from sklearn.linear_model import LogisticRegression\n","from sklearn.model_selection import GridSearchCV\n","from sklearn.model_selection import cross_val_score\n","import torch\n","import transformers as ppb\n","from sklearn.preprocessing import LabelEncoder\n","from sklearn.model_selection import train_test_split\n","import warnings\n","import re\n","warnings.filterwarnings('ignore')"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"YcCtVBHw6OyL"},"source":["##**Importing the dataset from Drive**"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dDgA4lpHw24H","executionInfo":{"status":"ok","timestamp":1620049684390,"user_tz":-60,"elapsed":39717,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"}},"outputId":"83b8aeab-c5be-435c-cf32-2355b778304f"},"source":["\n","from google.colab import drive \n","drive.mount('/content/gdrive')"],"execution_count":null,"outputs":[{"output_type":"stream","text":["Mounted at /content/gdrive\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"N8mxwPmXwQLw"},"source":["#Thunderbird\n","df1=pd.read_csv('gdrive/My Drive/test_dup_TB.csv',delimiter=';')\n","df2=pd.read_csv('gdrive/My Drive/test_Nondup_TB.csv',delimiter=';')"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"IxNxIhawCSgc"},"source":["df1['Label'] = 1\n","df2['Label'] = 0"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"oXDpKzHH68eY"},"source":["##**Loading the Pre-trained BERT model**"]},{"cell_type":"code","metadata":{"id":"NQu-ZrK0zIpZ","colab":{"base_uri":"https://localhost:8080/","height":262,"referenced_widgets":["6fd7c5c9bdbd493ab75fc477e455e294","94485c14a62a48b48a9725bde6e203b8","ff33bcc99ab04ac69ef249d624f2aeaf","0e2f05543898487e8ac564c3d9144d8e","d393f190fbea4de497548dcc5cf30994","040abc4e70f34fbf9fc709a98d99f5a4","cf40a2effa504d989394a8e049debb97","a3911f81c24845f5a6eade2417bbf153","3403afeea4ce44919fc0194612dc0028","863a5c9e64864220ac3255903c62bb76","b2fd5979c99a417aa55322432eb250e8","54902c4835e545f18463b5209029cd8b","b1852b809c154298b9f9ef6e86f80937","e41636d453c84ea7ae95faff494218c8","359eee31fa3d442cbc54f21e8cbaeaa0","c4e7c35940dd41679f5b148b02e51a4c","eaa2ccdfdb5b48ae82b298626615eafd","2d9edf4fd3974f4ea3d5bbce9a03ee43","4956547b260f4bdfb84e3b0f0ae78b07","4e43753c16cd4c989fe162de23f579fb","890cc2b1eb0b4b19a7098e2486042e8e","c700349663914ed299327e6a12eec1c2","ea87887bad484d60a103a7ce8916f9b3","079d0bcbe11240f39a238a2808a20971","1b770aec90874a88b568809c7863a2d0","73ef84f1708c411aac2ae001ee6843fc","26f97646300440778c73bce0cb9602f2","bb428e1e67f443f1a44917329ebcee35","0d15895a94a14f46b8131eb5b09e6362","f017003b15a04fcea81326b2792c6f0b","85a80965f0ae4178ae21e7945f83c154","b024a29e44af4c5aad2798c64d8f9645","d32cebf9783d43eaa4bc471c2a60684e","d0c867acfe2348549fe20d3b9b2fd11d","602f91d8164c4db4b827c2a772e0b7ac","1590d19477d741169284c6744943f4ea","a65ecef8a5774c368502476f206af885","81c045b02d0d4f0d92bbf8cf56b81756","16d5cdd9d47145f1ba2668e72ac6606f","163ef2ee33f24852b78ac7946991d4a7"]},"executionInfo":{"status":"ok","timestamp":1620049717302,"user_tz":-60,"elapsed":16240,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"}},"outputId":"e7a12d37-c7d8-4f11-f407-23f0ddfe2d66"},"source":["import time\n","start = time.time()\n","\n","model_class, tokenizer_class, pretrained_weights = (ppb.BertModel, ppb.BertTokenizer, 'bert-base-uncased')\n","tokenizer = tokenizer_class.from_pretrained(pretrained_weights)\n","model = model_class.from_pretrained(pretrained_weights)"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"6fd7c5c9bdbd493ab75fc477e455e294","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=231508.0, style=ProgressStyle(descripti…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"3403afeea4ce44919fc0194612dc0028","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=28.0, style=ProgressStyle(description_w…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"eaa2ccdfdb5b48ae82b298626615eafd","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=466062.0, style=ProgressStyle(descripti…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"1b770aec90874a88b568809c7863a2d0","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=570.0, style=ProgressStyle(description_…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"d32cebf9783d43eaa4bc471c2a60684e","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=440473133.0, style=ProgressStyle(descri…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"yXePBDNnYoaC"},"source":["# **Remove stop words**"]},{"cell_type":"code","metadata":{"id":"JVNkRAxRluFC"},"source":["df1['Title1']= df1['Title1'].str.replace(r'i' 'me' 'my' 'myself' 'we' \n","                                         'our' 'ours' 'ourselves' 'you' 'your' 'yours' 'yourself''yourselves' 'they' 'we' 'him' 'he' 'him' 'his' 'himself' 'she' 'her' 'hers' 'herself' 'it''its' 'itself' 'they' 'them' 'their' 'theirs' 'themselves'  'what' 'which' 'who' 'whom' 'this' 'that'\n","                                         'these' 'those' 'am' 'is' 'are' 'was' 'were' 'be' 'been' 'being' 'have' 'has' 'had' 'having' 'do' 'does' 'did' 'doing' 'a' 'an' 'the' 'and' 'but' 'if' 'or' 'because' 'as' 'until' 'while' 'of' 'at' 'by' 'for' 'with' 'about' 'against' 'between' 'into' 'through' \n","                                         'during' 'before' 'after' 'above' 'below' 'to' 'from' 'up' 'down' 'in' 'out' 'on' 'off' 'over' 'under' 'again' 'further' 'then' 'once'  'here' 'there' 'when' 'where' 'why' 'how' 'all' 'any' 'both' 'each' 'few' 'more' 'most' 'other' 'some' 'such' 'no' 'nor' 'not' 'only' 'own' 'same' 'so' 'than' 'too' 'very' 's' 't' 'can' 'will' 'just' 'don' 'should' 'now'\n","                                         'java' 'com' 'org' ,'')\n","\n","\n","df1['Title2']= df1['Title2'].str.replace(r'i' 'me' 'my' 'myself' 'we' \n","                                         'our' 'ours' 'ourselves' 'you' 'your' 'yours' 'yourself''yourselves' 'they' 'we' 'him' 'he' 'him' 'his' 'himself' 'she' 'her' 'hers' 'herself' 'it''its' 'itself' 'they' 'them' 'their' 'theirs' 'themselves'  'what' 'which' 'who' 'whom' 'this' 'that'\n","                                         'these' 'those' 'am' 'is' 'are' 'was' 'were' 'be' 'been' 'being' 'have' 'has' 'had' 'having' 'do' 'does' 'did' 'doing' 'a' 'an'\n","                                         'the' 'and' 'but' 'if' 'or' 'because' 'as' 'until' 'while' 'of' 'at' 'by' 'for' 'with' 'about' 'against' 'between' 'into' 'through' 'during' 'before' 'after' 'above' 'below' 'to' 'from' 'up' 'down' 'in' 'out' 'on' 'off' 'over' 'under' 'again' 'further' 'then' 'once' 'here' 'there' 'when' 'where' 'why' 'how' 'all' 'any' 'both' 'each' 'few' 'more' 'most' 'other' 'some' 'such' 'no' 'nor' 'not' 'only' 'own' \n","                                         'same' 'so' 'than' 'too' 'very' 's' 't' 'can' 'will' 'just' 'don' 'should' 'now'\n","                                         'java' 'com' 'org' ,'')\n","\n","df2['Title1']= df2['Title1'].str.replace(r'i' 'me' 'my' 'myself' 'we' 'our' 'ours' 'ourselves' 'you' 'your' 'yours' 'yourself''yourselves' 'they' 'we' 'him' 'he' 'him' 'his' 'himself' 'she'\n","                                         'her' 'hers' 'herself' 'it''its' 'itself' 'they' 'them' 'their' 'theirs' 'themselves'  'what' 'which' 'who' 'whom' 'this' 'that' 'these' 'those' 'am' 'is' 'are' 'was' 'were' 'be' 'been' 'being' 'have' 'has' 'had' 'having' 'do' 'does' 'did' 'doing' 'a' 'an'\n","                                         'the' 'and' 'but' 'if' 'or' 'because' 'as' 'until' 'while' 'of' 'at' 'by' 'for' 'with' 'about' 'against' 'between' 'into' 'through' \n","                                         'during' 'before' 'after' 'above' 'below' 'to' 'from' 'up' 'down' 'in' 'out' 'on' 'off' 'over' 'under' 'again' 'further' 'then' 'once' 'here' 'there' 'when' 'where' 'why' 'how' 'all' 'any' 'both' 'each' 'few' 'more' 'most' 'other' 'some' 'such' 'no' 'nor' 'not' 'only' 'own' 'same' 'so' 'than' 'too' 'very' 's' 't' 'can' 'will' 'just' 'don' 'should' 'now'\n","                                         'java' 'com' 'org' ,'')\n","\n","\n","df2['Title2']= df2['Title2'].str.replace(r'i' 'me' 'my' 'myself' 'we' 'our' 'ours' 'ourselves' 'you' 'your' 'yours' 'yourself''yourselves' 'they' 'we' 'him' 'he' 'him' 'his' 'himself' 'she'\n","                                         'her' 'hers' 'herself' 'it''its' 'itself' 'they' 'them' 'their' 'theirs' 'themselves'  'what' 'which' 'who' 'whom' 'this' 'that' 'these' 'those' 'am' 'is' 'are' 'was' 'were' 'be' 'been' 'being' 'have' 'has' 'had' 'having' 'do' 'does' 'did' 'doing' 'a' 'an'\n","                                         'the' 'and' 'but' 'if' 'or' 'because' 'as' 'until' 'while' 'of' 'at' 'by' 'for' 'with' 'about' 'against' 'between' 'into' 'through' \n","                                         'during' 'before' 'after' 'above' 'below' 'to' 'from' 'up' 'down' 'in' 'out' 'on' 'off' 'over' 'under' 'again' 'further' 'then' 'once' 'here' 'there' 'when' 'where' 'why' 'how' 'all' 'any' 'both' 'each' 'few' 'more' 'most' 'other' 'some' 'such' 'no' 'nor' 'not' 'only' 'own' \n","                                         'same' 'so' 'than' 'too' 'very' 's' 't' 'can' 'will' 'just' 'don' 'should' 'now'\n","                                         'java' 'com' 'org' ,'')\n","\n","df1['Description1']= df1['Description1'].str.replace(r'i' 'me' 'my' 'myself' 'we'  'our' 'ours' 'ourselves' 'you' 'your' 'yours' 'yourself''yourselves' 'they' 'we' 'him' 'he' 'him' 'his' 'himself' 'she'\n","                                         'her' 'hers' 'herself' 'it''its' 'itself' 'they' 'them' 'their' 'theirs' 'themselves'  'what' 'which' 'who' 'whom' 'this' 'that' 'these' 'those' 'am' 'is' 'are' 'was' 'were' 'be' 'been' 'being' 'have' 'has' 'had' 'having' 'do' 'does' 'did' 'doing' 'a' 'an' 'the' 'and' 'but' 'if' 'or' 'because' 'as' 'until' 'while' 'of' 'at' 'by' 'for' 'with' 'about' 'against' 'between' 'into' 'through' \n","                                         'during' 'before' 'after' 'above' 'below' 'to' 'from' 'up' 'down' 'in' 'out' 'on' 'off' 'over' 'under' 'again' 'further' 'then' 'once' \n","                                         'here' 'there' 'when' 'where' 'why' 'how' 'all' 'any' 'both' 'each' 'few' 'more' 'most' 'other' 'some' 'such' 'no' 'nor' 'not' 'only' 'own' 'same' 'so' 'than' 'too' 'very' 's' 't' 'can' 'will' 'just' 'don' 'should' 'now'\n","                                         'java' 'com' 'org' ,'')\n","\n","df1['Description2']= df1['Description2'].str.replace(r'i' 'me' 'my' 'myself' 'we' 'our' 'ours' 'ourselves' 'you' 'your' 'yours' 'yourself''yourselves' 'they' 'we' 'him' 'he' 'him' 'his' 'himself' 'she'\n","                                         'her' 'hers' 'herself' 'it''its' 'itself' 'they' 'them' 'their' 'theirs' 'themselves'  'what' 'which' 'who' 'whom' 'this' 'that' 'these' 'those' 'am' 'is' 'are' 'was' 'were' 'be' 'been' 'being' 'have' 'has' 'had' 'having' 'do' 'does' 'did' 'doing' 'a' 'an'\n","                                         'the' 'and' 'but' 'if' 'or' 'because' 'as' 'until' 'while' 'of' 'at' 'by' 'for' 'with' 'about' 'against' 'between' 'into' 'through' \n","                                         'during' 'before' 'after' 'above' 'below' 'to' 'from' 'up' 'down' 'in' 'out' 'on' 'off' 'over' 'under' 'again' 'further' 'then' 'once' 'here' 'there' 'when' 'where' 'why' 'how' 'all' 'any' 'both' 'each' 'few' 'more' 'most' 'other' 'some' 'such' 'no' 'nor' 'not' 'only' 'own' \n","                                         'same' 'so' 'than' 'too' 'very' 's' 't' 'can' 'will' 'just' 'don' 'should' 'now'\n","                                         'java' 'com' 'org' ,'')\n","\n","df2['Description1']= df2['Description1'].str.replace(r'i' 'me' 'my' 'myself' 'we' 'our' 'ours' 'ourselves' 'you' 'your' 'yours' 'yourself''yourselves' 'they' 'we' 'him' 'he' 'him' 'his' 'himself' 'she'\n","                                         'her' 'hers' 'herself' 'it''its' 'itself' 'they' 'them' 'their' 'theirs' 'themselves'  'what' 'which' 'who' 'whom' 'this' 'that' 'these' 'those' 'am' 'is' 'are' 'was' 'were' 'be' 'been' 'being' 'have' 'has' 'had' 'having' 'do' 'does' 'did' 'doing' 'a' 'an'\n","                                         'the' 'and' 'but' 'if' 'or' 'because' 'as' 'until' 'while' 'of' 'at' 'by' 'for' 'with' 'about' 'against' 'between' 'into' 'through' 'during' 'before' 'after' 'above' 'below' 'to' 'from' 'up' 'down' 'in' 'out' 'on' 'off' 'over' 'under' 'again' 'further' 'then' 'once' \n","                                         'here' 'there' 'when' 'where' 'why' 'how' 'all' 'any' 'both' 'each' 'few' 'more' 'most' 'other' 'some' 'such' 'no' 'nor' 'not' 'only' 'own' 'same' 'so' 'than' 'too' 'very' 's' 't' 'can' 'will' 'just' 'don' 'should' 'now'\n","                                         'java' 'com' 'org' ,'')\n","\n","df2['Description2']= df2['Description2'].str.replace(r'i' 'me' 'my' 'myself' 'we' 'our' 'ours' 'ourselves' 'you' 'your' 'yours' 'yourself''yourselves' 'they' 'we' 'him' 'he' 'him' 'his' 'himself' 'she'\n","                                         'her' 'hers' 'herself' 'it''its' 'itself' 'they' 'them' 'their' 'theirs' 'themselves'  'what' 'which' 'who' 'whom' 'this' 'that' 'these' 'those' 'am' 'is' 'are' 'was' 'were' 'be' 'been' 'being' 'have' 'has' 'had' 'having' 'do' 'does' 'did' 'doing' 'a' 'an'\n","                                         'the' 'and' 'but' 'if' 'or' 'because' 'as' 'until' 'while' 'of' 'at' 'by' 'for' 'with' 'about' 'against' 'between' 'into' 'through' 'during' 'before' 'after' 'above' 'below' 'to' 'from' 'up' 'down' 'in' 'out' 'on' 'off' 'over' 'under' 'again' 'further' 'then' 'once' \n","                                         'here' 'there' 'when' 'where' 'why' 'how' 'all' 'any' 'both' 'each' 'few' 'more' 'most' 'other' 'some' 'such' 'no' 'nor' 'not' 'only' 'own'  'same' 'so' 'than' 'too' 'very' 's' 't' 'can' 'will' 'just' 'don' 'should' 'now'\n","                                         'java' 'com' 'org' ,'')\n","\n","\n","\n","\n"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"f-GEFOyziCKS"},"source":["#**Batch ThunderBird**"]},{"cell_type":"code","metadata":{"id":"HzsZ95IlEJKQ"},"source":["batch_31=df1[:500]\n","batch_32=df2[:500]\n","df3 = pd.concat([batch_31,batch_32], ignore_index=True)\n","batch_41=df1[500:1000]\n","batch_42=df2[500:1000]\n","df4 = pd.concat([batch_41,batch_42], ignore_index=True)\n","batch_51=df1[1000:1500]\n","batch_52=df2[1000:1500]\n","df5 = pd.concat([batch_51,batch_52], ignore_index=True)\n","batch_61=df1[1500:2000]\n","batch_62=df2[1500:2000]\n","df6 = pd.concat([batch_61,batch_62], ignore_index=True)\n","batch_71=df1[2000:2500]\n","batch_72=df2[2000:2500]\n","df7 = pd.concat([batch_71,batch_72], ignore_index=True)\n","batch_81=df1[2500:3000]\n","batch_82=df2[2500:3000]\n","df8 = pd.concat([batch_81,batch_82], ignore_index=True)\n","batch_91=df1[3000:3486]\n","batch_92=df2[3000:3486]\n","df9 = pd.concat([batch_91,batch_92], ignore_index=True)\n","\n","\n","#Testing\n","batch_101=df1[3486:3900]\n","batch_102=df2[3486:3900]\n","df10 = pd.concat([batch_101,batch_102], ignore_index=True)\n","batch_111=df1[3900:4338]\n","batch_112=df2[3900:4374]\n","df11 = pd.concat([batch_111,batch_112], ignore_index=True)\n"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"aTcVvZLxicB_"},"source":["**Function: _get_segments3**"]},{"cell_type":"code","metadata":{"id":"XCoiTguWgxeg"},"source":["def _get_segments3(tokens, max_seq_length):\n","    \"\"\"Segments: 0 for the first sequence, 1 for the second\"\"\"\n","    if len(tokens)>max_seq_length:\n","        raise IndexError(\"Token length more than max seq length!\")\n","    segments = []\n","    first_sep = False\n","    current_segment_id = 0 \n","    for token in tokens:\n","        segments.append(current_segment_id)\n","        #print(token)\n","        if token == 102:\n","            #if first_sep:\n","                #first_sep = False \n","            #else:\n","           current_segment_id = 1\n","    return segments + [0] * (max_seq_length - len(tokens))"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"gOFGJdemfgnG"},"source":["#**df3**"]},{"cell_type":"code","metadata":{"id":"aZSPfF7rglgG"},"source":["pair3= df3['Title1'] + df3['Description1']+ [\" [SEP] \"] + df3['Title2'] + df3['Description2']\n","tokenized3 = pair3.apply((lambda x: tokenizer.encode(x, add_special_tokens=True,truncation=True, max_length=300)))\n","\n","max_len3 = 0                 # padding all lists to the same size\n","for i in tokenized3.values:\n","    if len(i) > max_len3:\n","        max_len3 = len(i)\n","max_len3 =300\n","padded3 = np.array([i + [0]*(max_len3-len(i)) for i in tokenized3.values])\n","\n","np.array(padded3).shape \n","\n","attention_mask3 = np.where(padded3 != 0, 1, 0)\n","attention_mask3.shape\n","input_ids3 = torch.tensor(padded3)  \n","attention_mask3 = torch.tensor(attention_mask3)\n","input_segments3= np.array([_get_segments3(token, max_len3)for token in tokenized3.values])\n","token_type_ids3 = torch.tensor(input_segments3)\n","input_segments3 = torch.tensor(input_segments3)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"1Nulz336hBcB"},"source":["with torch.no_grad():\n","    last_hidden_states3 = model(input_ids3, attention_mask=attention_mask3, token_type_ids=input_segments3)    # <<< 600 rows only !!!\n","features3 = last_hidden_states3[0][:,0,:].numpy()\n","features3    "],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"11le9CiUVDCO"},"source":["#**df4**"]},{"cell_type":"code","metadata":{"id":"-VsXGOj8IaZy"},"source":["pair4=df4['Title1'] + df4['Description1']+ [\" [SEP] \"] + df4['Title2']  + df4['Description2']\n","tokenized4 = pair4.apply((lambda x: tokenizer.encode(x, add_special_tokens=True,truncation=True, max_length=300)))\n","max_len4 = 0                 # padding all lists to the same size\n","for i in tokenized4.values:\n","    if len(i) > max_len4:\n","        max_len4 = len(i)\n","max_len4 =300\n","padded4 = np.array([i + [0]*(max_len4-len(i)) for i in tokenized4.values])\n","\n","np.array(padded4).shape\n","\n","attention_mask4 = np.where(padded4 != 0, 1, 0)\n","attention_mask4.shape\n","input_ids4 = torch.tensor(padded4)  \n","attention_mask4 = torch.tensor(attention_mask4)\n","input_segments4= np.array([_get_segments3(token, max_len4)for token in tokenized4.values])\n","token_type_ids4 = torch.tensor(input_segments4)\n","input_segments4 = torch.tensor(input_segments4)\n","\n","with torch.no_grad():\n","    last_hidden_states4 = model(input_ids4, attention_mask=attention_mask4, token_type_ids=input_segments4)   \n","features4 = last_hidden_states4[0][:,0,:].numpy()\n","features4  "],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"udmOsWumVKOa"},"source":["#**df5**"]},{"cell_type":"markdown","metadata":{"id":"wJ6WxdqsWF4N"},"source":["# **Tokenization**"]},{"cell_type":"code","metadata":{"id":"glQ0YXKhzyXZ"},"source":["pair5=df5['Title1'] + df5['Description1']+ [\" [SEP] \"] + df5['Title2'] + df5['Description2']\n","tokenized5 = pair5.apply((lambda x: tokenizer.encode(x, add_special_tokens=True,truncation=True, max_length=300)))"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"QvzhBBP081nL"},"source":["##**Padding**"]},{"cell_type":"code","metadata":{"id":"lR8b3SBtz6HA"},"source":["max_len5 = 0                 # padding all lists to the same size\n","for i in tokenized5.values:\n","    if len(i) > max_len5:\n","        max_len5 = len(i)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"OppURTFyz-pp","executionInfo":{"status":"ok","timestamp":1620049929228,"user_tz":-60,"elapsed":176229,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"}},"outputId":"e4b2ab26-ae91-49b8-ef9e-76890e83241b"},"source":["max_len5 =300\n","padded5 = np.array([i + [0]*(max_len5-len(i)) for i in tokenized5.values])\n","\n","np.array(padded5).shape        # Dimensions of the padded variable"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(1000, 300)"]},"metadata":{"tags":[]},"execution_count":16}]},{"cell_type":"markdown","metadata":{"id":"sOZ4VGE99GuU"},"source":["##**Masking**"]},{"cell_type":"code","metadata":{"id":"c9j3ZYcZ0BGt"},"source":["attention_mask5 = np.where(padded5 != 0, 1, 0)\n","attention_mask5.shape\n","input_ids5 = torch.tensor(padded5)  \n","attention_mask5 = torch.tensor(attention_mask5)"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"zqZuEvAPElvT"},"source":["##**Running the `model()` function through BERT**"]},{"cell_type":"code","metadata":{"id":"BijBFjIs581u"},"source":["input_segments5= np.array([_get_segments3(token, max_len5)for token in tokenized5.values])\n","token_type_ids5 = torch.tensor(input_segments5)\n","input_segments5 = torch.tensor(input_segments5)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"pd5IRqMXiMGm"},"source":["with torch.no_grad():\n","    last_hidden_states5 = model(input_ids5, attention_mask=attention_mask5, token_type_ids=input_segments5)    # <<< 600 rows only !!!"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"mlP88s-1FPZW"},"source":["##**Slicing the part of the output of BERT : [cls]**"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"iag0CM1N0Xhk","executionInfo":{"status":"ok","timestamp":1620050017248,"user_tz":-60,"elapsed":255158,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"}},"outputId":"80e3c145-56c8-499f-8f81-812a7589e680"},"source":["features5 = last_hidden_states5[0][:,0,:].numpy()\n","features5"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[-0.7150868 , -0.02143804, -0.53712595, ..., -0.96465296,\n","         0.49361002,  0.5210915 ],\n","       [-0.4751579 , -0.12975042, -0.21995719, ..., -0.7899966 ,\n","         0.5517666 ,  0.43111968],\n","       [-0.54855496,  0.00473771, -0.50283426, ..., -1.0070364 ,\n","         0.6967882 ,  0.66924685],\n","       ...,\n","       [-0.43534502, -0.23190856, -0.07703763, ..., -0.85549664,\n","         0.12206236,  0.3770517 ],\n","       [-0.6387902 , -0.24835777,  0.548509  , ..., -0.4204907 ,\n","         0.28891262,  0.33715272],\n","       [-0.35293338, -0.7598269 ,  0.09054194, ..., -0.6605442 ,\n","        -0.27124974,  0.38871494]], dtype=float32)"]},"metadata":{"tags":[]},"execution_count":20}]},{"cell_type":"markdown","metadata":{"id":"vCmfgIy9frZR"},"source":["#**df6**"]},{"cell_type":"code","metadata":{"id":"CRnTQdzMFJ6I"},"source":["pair6=df6['Title1'] + df6['Description1']+ [\" [SEP] \"] + df6['Title2'] + df6['Description2']\n","tokenized6 = pair6.apply((lambda x: tokenizer.encode(x, add_special_tokens=True,truncation=True, max_length=300)))\n","\n","max_len6 = 0                 # padding all lists to the same size\n","for i in tokenized6.values:\n","    if len(i) > max_len6:\n","        max_len6 = len(i)\n","\n","max_len6=300\n","padded6 = np.array([i + [0]*(max_len6-len(i)) for i in tokenized6.values])\n","\n","np.array(padded6).shape        # Dimensions of the padded variable        \n","\n","attention_mask6 = np.where(padded6 != 0, 1, 0)\n","attention_mask6.shape\n","input_ids6 = torch.tensor(padded6)  \n","attention_mask6 = torch.tensor(attention_mask6)\n","input_segments6= np.array([_get_segments3(token, max_len6)for token in tokenized6.values])\n","token_type_ids6 = torch.tensor(input_segments6)\n","input_segments6 = torch.tensor(input_segments6)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"ggFLgBpQjCn2","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1620050114780,"user_tz":-60,"elapsed":348341,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"}},"outputId":"7ef5764b-1ee5-48e2-db9f-ef342d85c9a9"},"source":["with torch.no_grad():\n","    last_hidden_states6 = model(input_ids6, attention_mask=attention_mask6, token_type_ids=input_segments6)   \n","features6 = last_hidden_states6[0][:,0,:].numpy()\n","features6    "],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[-0.70732516, -0.5288594 , -0.24584115, ..., -0.8108048 ,\n","         0.17355457,  0.7004055 ],\n","       [-0.66211164, -0.631361  , -0.278597  , ..., -0.8161972 ,\n","         0.01006048,  0.46472448],\n","       [-0.8070857 , -0.5031243 , -0.38067722, ..., -0.8365173 ,\n","         0.12972401,  0.4878298 ],\n","       ...,\n","       [-1.0213507 ,  0.29229   ,  0.33295104, ..., -0.52475005,\n","        -0.4046093 ,  0.59538054],\n","       [-0.8690153 , -0.75950116, -0.34593752, ..., -0.5983553 ,\n","        -0.5713401 ,  0.49073294],\n","       [-0.9294154 , -0.7963693 , -0.19163138, ..., -0.70108855,\n","         0.11923506,  0.8842914 ]], dtype=float32)"]},"metadata":{"tags":[]},"execution_count":22}]},{"cell_type":"markdown","metadata":{"id":"Mj5OSBQMf4-d"},"source":["#**df7**"]},{"cell_type":"code","metadata":{"id":"VWIWi1oAGaAO","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1620050192015,"user_tz":-60,"elapsed":423603,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"}},"outputId":"33162f85-da4b-4ef5-c8cd-50d0bf91f045"},"source":["pair7=df7['Title1'] + df7['Description1']+ [\" [SEP] \"] + df7['Title2'] + df7['Description2']\n","tokenized7 = pair7.apply((lambda x: tokenizer.encode(x, add_special_tokens=True,truncation=True, max_length=300)))\n","\n","max_len7 = 0                 # padding all lists to the same size\n","for i in tokenized7.values:\n","    if len(i) > max_len7:\n","        max_len7 = len(i)\n","\n","max_len7=300\n","padded7 = np.array([i + [0]*(max_len7-len(i)) for i in tokenized7.values])\n","\n","np.array(padded7).shape        # Dimensions of the padded variable    \n","\n","attention_mask7 = np.where(padded7 != 0, 1, 0)\n","attention_mask7.shape\n","input_ids7 = torch.tensor(padded7)  \n","attention_mask7 = torch.tensor(attention_mask7)\n","input_segments7= np.array([_get_segments3(token, max_len7)for token in tokenized7.values])\n","token_type_ids7 = torch.tensor(input_segments7)\n","input_segments7 = torch.tensor(input_segments7)\n","\n","with torch.no_grad():\n","    last_hidden_states7 = model(input_ids7, attention_mask=attention_mask7, token_type_ids=input_segments7)  \n","features7 = last_hidden_states7[0][:,0,:].numpy()\n","features7  "],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[-9.8698038e-01, -1.3887303e-01, -4.5795289e-01, ...,\n","        -9.5211393e-01,  2.8094152e-01,  3.0757031e-01],\n","       [-1.2537380e+00, -2.9895824e-01, -9.0455759e-01, ...,\n","        -8.4901375e-01,  3.3580768e-01,  1.9055209e-01],\n","       [-9.4350392e-01, -2.7118504e-01, -7.4354631e-01, ...,\n","        -9.5948952e-01,  3.2495996e-01,  3.2725292e-01],\n","       ...,\n","       [-4.9689385e-01, -8.4596081e-04,  4.0697443e-01, ...,\n","        -7.9819357e-01,  3.4487623e-01,  5.9828109e-01],\n","       [-4.9524376e-01,  2.8503007e-01, -4.3448916e-01, ...,\n","        -6.5762317e-01,  4.4116557e-01,  6.5292782e-01],\n","       [-2.8057069e-01, -9.6426927e-02,  2.0695898e-01, ...,\n","        -7.6929295e-01,  4.1371825e-01,  5.2288353e-01]], dtype=float32)"]},"metadata":{"tags":[]},"execution_count":23}]},{"cell_type":"markdown","metadata":{"id":"dJ3RvBPQf7fT"},"source":["#**df8**"]},{"cell_type":"code","metadata":{"id":"5VoQeXl4HEjN","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1620050267559,"user_tz":-60,"elapsed":495587,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"}},"outputId":"674d7639-ea83-43f6-a2f0-431b45dd367f"},"source":["pair8=df8['Title1'] + df8['Description1']+ [\" [SEP] \"] + df8['Title2'] + df8['Description2']\n","tokenized8 = pair8.apply((lambda x: tokenizer.encode(x, add_special_tokens=True,truncation=True, max_length=300)))\n","\n","max_len8 = 0                 # padding all lists to the same size\n","for i in tokenized8.values:\n","    if len(i) > max_len8:\n","        max_len8 = len(i)\n","max_len8=300\n","padded8 = np.array([i + [0]*(max_len8-len(i)) for i in tokenized8.values])\n","\n","np.array(padded8).shape        # Dimensions of the padded variable  \n","\n","\n","attention_mask8 = np.where(padded8 != 0, 1, 0)\n","attention_mask8.shape\n","input_ids8 = torch.tensor(padded8)  \n","attention_mask8 = torch.tensor(attention_mask8)\n","input_segments8= np.array([_get_segments3(token, max_len8)for token in tokenized8.values])\n","token_type_ids8 = torch.tensor(input_segments8)\n","input_segments8 = torch.tensor(input_segments8)\n","\n","with torch.no_grad():\n","    last_hidden_states8 = model(input_ids8, attention_mask=attention_mask8, token_type_ids=input_segments8)   \n","features8 = last_hidden_states8[0][:,0,:].numpy()\n","features8 "],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[-0.60438377, -0.23395938, -0.23888819, ..., -0.99630904,\n","         0.35000739,  0.59743845],\n","       [-0.51569384, -0.22046532, -0.12570295, ..., -0.91783315,\n","         0.387859  ,  0.62774307],\n","       [-0.57614255, -0.25033358, -0.10001289, ..., -0.88637775,\n","         0.33012143,  0.70312077],\n","       ...,\n","       [-0.09259659, -0.09115582,  0.48812208, ..., -0.20511687,\n","         0.33231604,  0.36783996],\n","       [-0.72485876,  0.0556468 ,  0.19721866, ..., -0.6981154 ,\n","         0.65800685,  0.42406514],\n","       [-0.3090534 , -0.1548558 , -0.08121514, ..., -0.88274175,\n","         0.25526923,  0.43774956]], dtype=float32)"]},"metadata":{"tags":[]},"execution_count":24}]},{"cell_type":"markdown","metadata":{"id":"rNXTxV1l0pIJ"},"source":["#**df9**"]},{"cell_type":"code","metadata":{"id":"sk-H7hcUH7cg"},"source":["pair9=df9['Title1'] + df9['Description1']+ [\" [SEP] \"] + df9['Title2'] + df9['Description2']\n","tokenized9 = pair9.apply((lambda x: tokenizer.encode(x, add_special_tokens=True,truncation=True, max_length=300)))\n","\n","max_len9 = 0                 # padding all lists to the same size\n","for i in tokenized9.values:\n","    if len(i) > max_len9:\n","        max_len9 = len(i)\n","max_len9=300\n","padded9 = np.array([i + [0]*(max_len9-len(i)) for i in tokenized9.values])\n","\n","np.array(padded9).shape        # Dimensions of the padded variable    \n","\n","attention_mask9 = np.where(padded9 != 0, 1, 0)\n","attention_mask9.shape\n","input_ids9 = torch.tensor(padded9)  \n","attention_mask9 = torch.tensor(attention_mask9)\n","input_segments9= np.array([_get_segments3(token, max_len9)for token in tokenized9.values])\n","token_type_ids9 = torch.tensor(input_segments9)\n","input_segments9 = torch.tensor(input_segments9)\n","\n","with torch.no_grad():\n","    last_hidden_states9 = model(input_ids9, attention_mask=attention_mask9, token_type_ids=input_segments9)    \n","features9 = last_hidden_states9[0][:,0,:].numpy()\n","features9"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"0ok-IVZl0xID"},"source":["#**df10**"]},{"cell_type":"code","metadata":{"id":"bfnW68FxIlN1","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1620050419913,"user_tz":-60,"elapsed":640579,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"}},"outputId":"a378c6f1-4712-4b00-d3c9-c47371e98343"},"source":["pair10=df10['Title1'] + df10['Description1']+ [\" [SEP] \"] + df10['Title2'] + df10['Description2']\n","tokenized10 = pair10.apply((lambda x: tokenizer.encode(x, add_special_tokens=True,truncation=True, max_length=300)))\n","max_len10 = 0                 # padding all lists to the same size\n","for i in tokenized10.values:\n","    if len(i) > max_len10:\n","        max_len10 = len(i)\n","max_len10=300\n","padded10 = np.array([i + [0]*(max_len10-len(i)) for i in tokenized10.values])\n","\n","np.array(padded10).shape        # Dimensions of the padded variable\n","\n","attention_mask10 = np.where(padded10 != 0, 1, 0)\n","attention_mask10.shape\n","input_ids10 = torch.tensor(padded10)  \n","attention_mask10 = torch.tensor(attention_mask10)\n","input_segments10= np.array([_get_segments3(token, max_len10)for token in tokenized10.values])\n","token_type_ids10 = torch.tensor(input_segments10)\n","input_segments10 = torch.tensor(input_segments10)\n","\n","with torch.no_grad():\n","    last_hidden_states10 = model(input_ids10, attention_mask=attention_mask10, token_type_ids=input_segments10) \n","features10 = last_hidden_states10[0][:,0,:].numpy()\n","features10\n"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[-0.92287654,  0.09879377, -0.21756157, ..., -0.9992561 ,\n","         0.31372535,  0.4032963 ],\n","       [-0.93001735, -0.39391732, -0.32802412, ..., -0.7144583 ,\n","         0.30027574,  0.52159935],\n","       [-0.8750404 ,  0.11880389, -0.5262182 , ..., -0.8546316 ,\n","         0.6586568 ,  0.63991576],\n","       ...,\n","       [-0.3293789 , -0.12245314, -0.33827764, ..., -1.0260113 ,\n","         0.04016275,  0.7023087 ],\n","       [-0.80368096, -0.46616802, -0.06866035, ..., -0.6966629 ,\n","         0.1788419 ,  0.46562386],\n","       [-0.65271634, -0.67289346,  0.19383666, ..., -0.77868676,\n","         0.43395802,  0.8837701 ]], dtype=float32)"]},"metadata":{"tags":[]},"execution_count":26}]},{"cell_type":"markdown","metadata":{"id":"dJ_ER9DhCQGj"},"source":["#**df11**"]},{"cell_type":"code","metadata":{"id":"kmG3KS5TJffr"},"source":["pair11=df11['Title1'] + df11['Description1']+ [\" [SEP] \"] + df11['Title2'] + df11['Description2']\n","tokenized11 = pair11.apply((lambda x: tokenizer.encode(x, add_special_tokens=True,truncation=True, max_length=300)))\n","\n","max_len11 = 0                 # padding all lists to the same size\n","for i in tokenized11.values:\n","    if len(i) > max_len11:\n","        max_len11 = len(i)\n","max_len11=300\n","padded11 = np.array([i + [0]*(max_len11-len(i)) for i in tokenized11.values])\n","\n","np.array(padded11).shape        # Dimensions of the padded variable   \n","\n","attention_mask11 = np.where(padded11 != 0, 1, 0)\n","attention_mask11.shape\n","input_ids11 = torch.tensor(padded11)  \n","attention_mask11 = torch.tensor(attention_mask11)\n","input_segments11= np.array([_get_segments3(token, max_len11)for token in tokenized11.values])\n","token_type_ids11 = torch.tensor(input_segments11)\n","input_segments11 = torch.tensor(input_segments11)\n","\n","\n","with torch.no_grad():\n","    last_hidden_states11 = model(input_ids11, attention_mask=attention_mask11, token_type_ids=input_segments11)   \n","features11 = last_hidden_states11[0][:,0,:].numpy()\n","features11    "],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"z6m1jSq0fvSK"},"source":["#**Classification**"]},{"cell_type":"code","metadata":{"id":"_fQOGOczXPSr"},"source":["features=np.concatenate([features3,features4,features5,features6,features7,features8,features9,features10,features11])"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"eWLJczI21W7N","executionInfo":{"status":"ok","timestamp":1619394572887,"user_tz":-60,"elapsed":712,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"}},"outputId":"a7badac4-12d0-4841-ff79-8257a989c50f"},"source":["features.shape"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(18500, 768)"]},"metadata":{"tags":[]},"execution_count":72}]},{"cell_type":"code","metadata":{"id":"axi2Jeq5zfpG"},"source":["Total = pd.concat([df3,df4,df5,df6,df7,df8,df9,df10,df11], ignore_index=True)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"N_15I5LWzLoQ","executionInfo":{"status":"ok","timestamp":1620000051570,"user_tz":-60,"elapsed":770,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"}},"outputId":"b6141f6d-652e-4878-9ece-4b2a1c4f3de7"},"source":["labels =Total['Label']\n","labels"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0            Duplicate\n","1            Duplicate\n","2            Duplicate\n","3            Duplicate\n","4            Duplicate\n","             ...      \n","18495    Non Duplicate\n","18496    Non Duplicate\n","18497    Non Duplicate\n","18498    Non Duplicate\n","18499    Non Duplicate\n","Name: Label, Length: 18500, dtype: object"]},"metadata":{"tags":[]},"execution_count":52}]},{"cell_type":"markdown","metadata":{"id":"qs5eiuYdG2pW"},"source":["Hold out "]},{"cell_type":"code","metadata":{"id":"j_hjZHRuiiD6"},"source":["train_features = features[0:3486]\n","train_labels = labels[0:3486]\n","test_features = features[3486:]\n","test_labels = labels[3486:]"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"nG_ymUrw3ozc"},"source":["#**LogisticRegression Optimized**\n","\n","---\n","\n"]},{"cell_type":"code","metadata":{"id":"kM9yUlFcybbL"},"source":["#n_splits=2\n","#cross_val_score=5\n","parameters = {'C': np.linspace(0.0001, 100, 20)}\n","grid_search = GridSearchCV(LogisticRegression(), parameters, cv=5)\n","grid_search.fit(train_features, train_labels)\n","print('best parameters: ', grid_search.best_params_)\n","print('best scrores: ', grid_search.best_score_)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"DKr7gDRz5S2L","executionInfo":{"elapsed":14560,"status":"ok","timestamp":1617842979975,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"b260c580-ffe0-4be3-886f-4b582fe369f8"},"source":["#n_splits=2\n","#cross_val_score=5\n","parameters = {'C': np.linspace(0.0001, 100, 20)}\n","grid_search = GridSearchCV(LogisticRegression(), parameters, cv=5)\n","grid_search.fit(train_features, train_labels)\n","print('best parameters: ', grid_search.best_params_)\n","print('best scrores: ', grid_search.best_score_)"],"execution_count":null,"outputs":[{"output_type":"stream","text":["best parameters:  {'C': 10.526405263157894}\n","best scrores:  0.8795155660978488\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"7rm32RA-HgBd","executionInfo":{"elapsed":1691,"status":"ok","timestamp":1617846876834,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"50fe20e1-d01d-4b21-e972-6fea950f8813"},"source":["lr_clf = LogisticRegression(C=10.52)\n","lr_clf.fit(train_features, train_labels)\n"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["LogisticRegression(C=10.52, class_weight=None, dual=False, fit_intercept=True,\n","                   intercept_scaling=1, l1_ratio=None, max_iter=100,\n","                   multi_class='auto', n_jobs=None, penalty='l2',\n","                   random_state=None, solver='lbfgs', tol=0.0001, verbose=0,\n","                   warm_start=False)"]},"metadata":{"tags":[]},"execution_count":51}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"8sm8PZlaHo-b","executionInfo":{"elapsed":587,"status":"ok","timestamp":1617645325677,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"b26c2c4c-4e0a-4bf4-a392-82de62bb3432"},"source":["lr_clf.score(test_features, test_labels)"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.8828947368421053"]},"metadata":{"tags":[]},"execution_count":67}]},{"cell_type":"code","metadata":{"id":"0ICHUVuhRs3X"},"source":["y_predLr = lr_clf.predict(test_features)\n","np.set_printoptions(threshold=np.inf)\n","y_predLr"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vKbU0wQtSN7M","executionInfo":{"elapsed":779,"status":"ok","timestamp":1617843124582,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"45502a02-b07b-4daf-899e-f7ab7fc6f283"},"source":["from sklearn.metrics import classification_report, confusion_matrix\n","print(classification_report(test_labels,y_predLr))\n","print(confusion_matrix(test_labels, y_predLr))"],"execution_count":null,"outputs":[{"output_type":"stream","text":["              precision    recall  f1-score   support\n","\n","           0       0.86      0.84      0.85      2874\n","           1       0.81      0.83      0.82      2352\n","\n","    accuracy                           0.84      5226\n","   macro avg       0.84      0.84      0.84      5226\n","weighted avg       0.84      0.84      0.84      5226\n","\n","[[2419  455]\n"," [ 393 1959]]\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"W6uV_wgzvP53","executionInfo":{"elapsed":1293,"status":"ok","timestamp":1617843128770,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"ae90d199-f302-4f6c-d9e3-da552e2bf0e3"},"source":["from sklearn.metrics import accuracy_score\n","print(accuracy_score(test_labels, y_predLr))"],"execution_count":null,"outputs":[{"output_type":"stream","text":["0.837734404898584\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dZ6fZqC6Wo7v","executionInfo":{"elapsed":6985,"status":"ok","timestamp":1617645365302,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"e0daa004-b4c6-4848-db02-d802aef951e6"},"source":["scores = cross_val_score(lr_clf, features, labels,cv=5)\n","print(\"mean: {:.3f} (std: {:.3f})\".format(scores.mean(),\n","                                          scores.std()),\n","                                          end=\"\\n\\n\" )"],"execution_count":null,"outputs":[{"output_type":"stream","text":["mean: 0.888 (std: 0.008)\n","\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"GklbE2mcyFKb"},"source":["#**Decision tree**"]},{"cell_type":"code","metadata":{"id":"9tW7vrR9yQaZ"},"source":["from sklearn.tree import DecisionTreeClassifier"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"cLU-AQqIxzJI"},"source":["clf = DecisionTreeClassifier(max_depth = 500, random_state = 0)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ygtC-1A9ycDW","executionInfo":{"elapsed":56817,"status":"ok","timestamp":1617645437386,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"6cfe64c2-db28-403d-ff57-bbb200b1039e"},"source":["clf.fit(train_features, train_labels)"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["DecisionTreeClassifier(ccp_alpha=0.0, class_weight=None, criterion='gini',\n","                       max_depth=500, max_features=None, max_leaf_nodes=None,\n","                       min_impurity_decrease=0.0, min_impurity_split=None,\n","                       min_samples_leaf=1, min_samples_split=2,\n","                       min_weight_fraction_leaf=0.0, presort='deprecated',\n","                       random_state=0, splitter='best')"]},"metadata":{"tags":[]},"execution_count":77}]},{"cell_type":"code","metadata":{"id":"JvKjL68bSqi2"},"source":["y_preddt = clf.predict(test_features)\n","np.set_printoptions(threshold=np.inf)\n","y_preddt"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"kerN3aUaSpfh","executionInfo":{"elapsed":49193,"status":"ok","timestamp":1617645437392,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"1e102d28-1db7-4ea7-fee9-17970a9abc85"},"source":["from sklearn.metrics import classification_report, confusion_matrix\n","print(classification_report(test_labels,y_preddt))\n","print(confusion_matrix(test_labels, y_preddt))"],"execution_count":null,"outputs":[{"output_type":"stream","text":["              precision    recall  f1-score   support\n","\n","           0       0.89      0.80      0.84      2356\n","           1       0.72      0.85      0.78      1444\n","\n","    accuracy                           0.82      3800\n","   macro avg       0.81      0.82      0.81      3800\n","weighted avg       0.83      0.82      0.82      3800\n","\n","[[1878  478]\n"," [ 221 1223]]\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"7eIUnRYivoEP","executionInfo":{"elapsed":44125,"status":"ok","timestamp":1617645437395,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"7c0a11e0-193a-4c41-e4d8-a8c4921dcb9d"},"source":["from sklearn.metrics import accuracy_score\n","print(accuracy_score(test_labels, y_preddt))"],"execution_count":null,"outputs":[{"output_type":"stream","text":["0.8160526315789474\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":34},"id":"WrVSkqR0y71G","executionInfo":{"elapsed":650,"status":"ok","timestamp":1601919492440,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"d6d6b039-14f0-4d2a-b01b-d2999188066a"},"source":["# The score method returns the accuracy of the model\n","score = clf.score(test_features, test_labels)\n","print(score)"],"execution_count":null,"outputs":[{"output_type":"stream","text":["0.5765\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"9tR2H-yHmxqJ","executionInfo":{"elapsed":295086,"status":"ok","timestamp":1617645691484,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"77a23a1b-40cc-4330-c167-7afbf8a085cc"},"source":["scores = cross_val_score(clf, features, labels, cv=5)\n","print(\"mean: {:.3f} (std: {:.3f})\".format(scores.mean(),\n","                                          scores.std()),\n","                                          end=\"\\n\\n\" )"],"execution_count":null,"outputs":[{"output_type":"stream","text":["mean: 0.814 (std: 0.005)\n","\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"ZkQR7uLE22Y0"},"source":["#**SVM**"]},{"cell_type":"code","metadata":{"id":"T16t0BN2thID"},"source":["from sklearn.svm import SVC"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Q6CgvC0n21oc","executionInfo":{"elapsed":170843,"status":"ok","timestamp":1617645871553,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"01e2f103-be17-4f7c-d111-719dfc868907"},"source":["\n","svclassifier = SVC(kernel='linear')\n","svclassifier.fit(train_features, train_labels)"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["SVC(C=1.0, break_ties=False, cache_size=200, class_weight=None, coef0=0.0,\n","    decision_function_shape='ovr', degree=3, gamma='scale', kernel='linear',\n","    max_iter=-1, probability=False, random_state=None, shrinking=True,\n","    tol=0.001, verbose=False)"]},"metadata":{"tags":[]},"execution_count":84}]},{"cell_type":"code","metadata":{"id":"DLyTKn6K3yqj"},"source":["y_pred = svclassifier.predict(test_features)\n","np.set_printoptions(threshold=np.inf)\n","y_pred"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"qmHE07TI4HCh"},"source":["from sklearn.metrics import classification_report, confusion_matrix\n","print(confusion_matrix(test_labels,y_pred))\n","print(classification_report(test_labels,y_pred))"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"rQXTzIAKvxpe","executionInfo":{"elapsed":1790,"status":"ok","timestamp":1617645915322,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"f8479314-c547-49d2-86c5-00f1f5545d36"},"source":["from sklearn.metrics import accuracy_score\n","print(accuracy_score(test_labels, y_pred))"],"execution_count":null,"outputs":[{"output_type":"stream","text":["0.8797368421052632\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ArvTazd6qpr9","executionInfo":{"elapsed":906844,"status":"ok","timestamp":1617646830623,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"6da6ce8a-5397-48cf-ee15-cb27bddafb9f"},"source":["scores = cross_val_score(svclassifier,features, labels, cv=5)\n","print(\"mean: {:.3f} (std: {:.3f})\".format(scores.mean(),\n","                                          scores.std()),\n","                                          end=\"\\n\\n\" )"],"execution_count":null,"outputs":[{"output_type":"stream","text":["mean: 0.885 (std: 0.006)\n","\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"-GfWBgit7kKc"},"source":["#**MLP Best params**"]},{"cell_type":"code","metadata":{"id":"2jo__QQE7omY"},"source":["from sklearn.neural_network import MLPClassifier\n","mlp = MLPClassifier(max_iter=100)\n","from sklearn.datasets import make_classification"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"fS44TAenh4zR"},"source":["parameter_space = {\n","    'hidden_layer_sizes': [(50,100,50), (50,100,50), (100,)],\n","    'activation': ['tanh', 'relu'],\n","    'solver': ['sgd', 'adam'],\n","    'alpha': [0.0001, 0.05],\n","    'learning_rate': ['constant','adaptive'],\n","}"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"dnwD6IhehjFW","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1619749763719,"user_tz":-60,"elapsed":156653,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"}},"outputId":"7b3529e3-6faa-48c1-fc00-30416faf8cb9"},"source":["from sklearn.model_selection import GridSearchCV\n","\n","clf = GridSearchCV(mlp, parameter_space, n_jobs=-1, cv=3)\n","clf.fit(train_features, train_labels)"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["GridSearchCV(cv=3, error_score=nan,\n","             estimator=MLPClassifier(activation='relu', alpha=0.0001,\n","                                     batch_size='auto', beta_1=0.9,\n","                                     beta_2=0.999, early_stopping=False,\n","                                     epsilon=1e-08, hidden_layer_sizes=(100,),\n","                                     learning_rate='constant',\n","                                     learning_rate_init=0.001, max_fun=15000,\n","                                     max_iter=100, momentum=0.9,\n","                                     n_iter_no_change=10,\n","                                     nesterovs_momentum=True, power_t=0.5,\n","                                     random_state...\n","                                     solver='adam', tol=0.0001,\n","                                     validation_fraction=0.1, verbose=False,\n","                                     warm_start=False),\n","             iid='deprecated', n_jobs=-1,\n","             param_grid={'activation': ['tanh', 'relu'],\n","                         'alpha': [0.0001, 0.05],\n","                         'hidden_layer_sizes': [(50, 100, 50), (50, 100, 50),\n","                                                (100,)],\n","                         'learning_rate': ['constant', 'adaptive'],\n","                         'solver': ['sgd', 'adam']},\n","             pre_dispatch='2*n_jobs', refit=True, return_train_score=False,\n","             scoring=None, verbose=0)"]},"metadata":{"tags":[]},"execution_count":37}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Q3R7Hhe-KUWC","executionInfo":{"status":"ok","timestamp":1619749763724,"user_tz":-60,"elapsed":127652,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"}},"outputId":"f6ce7560-a342-4c8f-8174-33eb16494b05"},"source":["# Best paramete set\n","print('Best parameters found:\\n', clf.best_params_)"],"execution_count":null,"outputs":[{"output_type":"stream","text":["Best parameters found:\n"," {'activation': 'tanh', 'alpha': 0.05, 'hidden_layer_sizes': (50, 100, 50), 'learning_rate': 'adaptive', 'solver': 'adam'}\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"D4iS97yMiCXi"},"source":["\n","\n","# All results\n","means = clf.cv_results_['mean_test_score']\n","stds = clf.cv_results_['std_test_score']\n","for mean, std, params in zip(means, stds, clf.cv_results_['params']):\n","    print(\"%0.3f (+/-%0.03f) for %r\" % (mean, std * 2, params))\n"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"ur092BrFxETo"},"source":["\n","\n","y_true, y_pred = test_labels , clf.predict(test_features)\n","np.set_printoptions(threshold=np.inf)\n","y_pred"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"hCVtqVsfizFy"},"source":["\n","\n","from sklearn.metrics import classification_report, confusion_matrix\n","print('Results on the test set:')\n","print(classification_report(y_true, y_pred))\n","print(confusion_matrix(y_true, y_pred))"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"OfQ3_jlMLZTJ"},"source":["y_true, y_pred = test_labels , clf.predict(test_features)\n"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"HV96Dn8xwINN","executionInfo":{"status":"ok","timestamp":1619736774387,"user_tz":-60,"elapsed":1201,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"}},"outputId":"22b56ee3-54ad-4300-d2c4-13a7aecdeadc"},"source":["from sklearn.metrics import accuracy_score\n","print(accuracy_score(y_true, y_pred))"],"execution_count":null,"outputs":[{"output_type":"stream","text":["0.46842709529276694\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"W7XXMqpz8kI5","executionInfo":{"elapsed":875,"status":"ok","timestamp":1616615168623,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"54ae4da9-eaf5-480e-f896-44f0036f1e4d"},"source":["clf.score(test_features, test_labels)"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.8694046654057462"]},"metadata":{"tags":[]},"execution_count":86}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"m49YtVHa99I9","executionInfo":{"elapsed":1794792,"status":"ok","timestamp":1617649428827,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"87f516ec-f5cc-4d95-ab1a-be17d49b43c4"},"source":["\n","scores = cross_val_score(clf, features, labels, cv=5)\n","print(\"mean: {:.3f} (std: {:.3f})\".format(scores.mean(),\n","                                          scores.std()),\n","                                          end=\"\\n\\n\" )"],"execution_count":null,"outputs":[{"output_type":"stream","text":["mean: 0.892 (std: 0.006)\n","\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"rkStE77lVPjB"},"source":["#**Random Forest**"]},{"cell_type":"code","metadata":{"id":"-Cvq-n5HVUH2"},"source":["from sklearn.ensemble import RandomForestClassifier\n","\n","rf = RandomForestClassifier(n_estimators=20, random_state=0)\n","rf.fit(train_features, train_labels)\n","y_pred1 = rf.predict(test_features)\n","y_pred1"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"ORiXr8DQI5E5"},"source":["from sklearn.metrics import classification_report, confusion_matrix\n","print(classification_report(test_labels,y_pred1))\n","print(confusion_matrix(test_labels, y_pred1))"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3AOvVQIjwSQ_","executionInfo":{"elapsed":4584,"status":"ok","timestamp":1617650580582,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"8abbb569-9604-4c5d-ea24-12be0097498e"},"source":["from sklearn.metrics import accuracy_score\n","print(accuracy_score(test_labels, y_pred1))"],"execution_count":null,"outputs":[{"output_type":"stream","text":["0.8936842105263157\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"yLS7LQUBVlgo","executionInfo":{"elapsed":66915,"status":"ok","timestamp":1617650659712,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"f2876ffb-2039-4d52-8e6a-036f14c86ce4"},"source":["scores = cross_val_score(rf, features, labels, cv=5)\n","print(\"mean: {:.3f} (std: {:.3f})\".format(scores.mean(),\n","                                          scores.std()),\n","                                          end=\"\\n\\n\" )"],"execution_count":null,"outputs":[{"output_type":"stream","text":["mean: 0.872 (std: 0.012)\n","\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"UK1v4gA6-ssL"},"source":["#**Naive Bayes**"]},{"cell_type":"markdown","metadata":{"id":"fEsrF7jnB8ck"},"source":["#Gaussian"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"x4-7126r-110","executionInfo":{"elapsed":62008,"status":"ok","timestamp":1617650659716,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"6ef4c162-598e-4620-e960-15a14f557df9"},"source":["from sklearn.naive_bayes import GaussianNB\n","gnb = GaussianNB()\n","gnb.fit(train_features, train_labels)"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["GaussianNB(priors=None, var_smoothing=1e-09)"]},"metadata":{"tags":[]},"execution_count":109}]},{"cell_type":"code","metadata":{"id":"lD6bQGaX_Ch8"},"source":["y_pred = gnb.predict(test_features)\n","y_pred"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"gNCBuGYI_HeA","executionInfo":{"elapsed":55581,"status":"ok","timestamp":1617650659727,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"3322d7ab-5a78-499e-8a0f-3782a6b0aa24"},"source":["from sklearn import metrics\n","print(\"Accuracy:\",metrics.accuracy_score(test_labels, y_pred))"],"execution_count":null,"outputs":[{"output_type":"stream","text":["Accuracy: 0.8010526315789473\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"ZNq7MJ3eG4r1"},"source":["from sklearn.metrics import classification_report, confusion_matrix\n","print(classification_report(test_labels,y_pred))\n","print(confusion_matrix(test_labels, y_pred))"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"sfE0-AH4DltJ"},"source":["*Cross Validation*"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"k9n7Rtxd7avI","executionInfo":{"elapsed":1568,"status":"ok","timestamp":1617650719346,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"7a22e97b-cba5-45f3-8225-49fde862446e"},"source":["\n","scores = cross_val_score(gnb, features, labels, cv=5)\n","print(\"mean: {:.3f} (std: {:.3f})\".format(scores.mean(),\n","                                          scores.std()),\n","                                          end=\"\\n\\n\" )"],"execution_count":null,"outputs":[{"output_type":"stream","text":["mean: 0.817 (std: 0.005)\n","\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"XAXuL31Rqv2B"},"source":["#**XGBoost**"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"rS6XD1Wl5aCJ","executionInfo":{"elapsed":80565,"status":"ok","timestamp":1617650801272,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"2fa9fe7b-6efe-43e3-91b7-267648b5d9bd"},"source":["import xgboost as xgb\n","modelxgb=xgb.XGBClassifier(random_state=1,learning_rate=0.01)\n","modelxgb.fit(train_features, train_labels)\n"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["XGBClassifier(base_score=0.5, booster='gbtree', colsample_bylevel=1,\n","              colsample_bynode=1, colsample_bytree=1, gamma=0,\n","              learning_rate=0.01, max_delta_step=0, max_depth=3,\n","              min_child_weight=1, missing=None, n_estimators=100, n_jobs=1,\n","              nthread=None, objective='binary:logistic', random_state=1,\n","              reg_alpha=0, reg_lambda=1, scale_pos_weight=1, seed=None,\n","              silent=None, subsample=1, verbosity=1)"]},"metadata":{"tags":[]},"execution_count":115}]},{"cell_type":"code","metadata":{"id":"VERUlLMfVcff"},"source":["predxgb = modelxgb.predict(test_features)\n","predxgb"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3VDVkMJ8VxEs","executionInfo":{"elapsed":74404,"status":"ok","timestamp":1617650801285,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"9a449943-0d0b-437f-d534-888872f3350a"},"source":["from sklearn.metrics import classification_report, confusion_matrix\n","print(classification_report(test_labels,predxgb))\n","print(confusion_matrix(test_labels, predxgb))"],"execution_count":null,"outputs":[{"output_type":"stream","text":["              precision    recall  f1-score   support\n","\n","           0       0.92      0.88      0.90      2356\n","           1       0.82      0.88      0.85      1444\n","\n","    accuracy                           0.88      3800\n","   macro avg       0.87      0.88      0.88      3800\n","weighted avg       0.89      0.88      0.88      3800\n","\n","[[2081  275]\n"," [ 169 1275]]\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"EZvEqHDkh5T9","executionInfo":{"elapsed":62335,"status":"ok","timestamp":1617650801297,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"8932d4ce-71cf-456c-c0a7-6cb46798f466"},"source":["from sklearn.metrics import accuracy_score\n","print(accuracy_score(test_labels, predxgb))"],"execution_count":null,"outputs":[{"output_type":"stream","text":["0.8831578947368421\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"wHThKNgWELHA","executionInfo":{"elapsed":59955,"status":"ok","timestamp":1617650801300,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"bf7fcafb-b5ac-4bf9-8711-8138a6ff94b1"},"source":["modelxgb.score(test_features,test_labels)\n"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.8831578947368421"]},"metadata":{"tags":[]},"execution_count":120}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"hUPXhje3Em-x","executionInfo":{"elapsed":434873,"status":"ok","timestamp":1617651180166,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"cda68fdc-2a4c-4c80-e0f9-16b59c19f9cd"},"source":["scores = cross_val_score(modelxgb, features, labels, cv=5)\n","print(\"mean: {:.3f} (std: {:.3f})\".format(scores.mean(),\n","                                          scores.std()),\n","                                          end=\"\\n\\n\" )"],"execution_count":null,"outputs":[{"output_type":"stream","text":["mean: 0.863 (std: 0.015)\n","\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"PtBlFouhFeDi"},"source":["#**KNN**"]},{"cell_type":"code","metadata":{"id":"zXg9cPXey1su"},"source":["#import KNeighborsClassifier\n","from sklearn.neighbors import KNeighborsClassifier\n","\n","#Setup arrays to store training and test accuracies\n","neighbors = np.arange(1,9)\n","train_accuracy =np.empty(len(neighbors))\n","test_accuracy = np.empty(len(neighbors))\n","\n","for i,k in enumerate(neighbors):\n","    #Setup a knn classifier with k neighbors\n","    knn = KNeighborsClassifier(n_neighbors=k)\n","    \n","    #Fit the model\n","    knn.fit(train_features, train_labels)\n","    \n","    #Compute accuracy on the training set\n","    train_accuracy[i] = knn.score(train_features, train_labels)\n","    \n","    #Compute accuracy on the test set\n","    test_accuracy[i] = knn.score(test_features, test_labels) "],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"PvGnHUIV6KQd"},"source":["import matplotlib.pyplot as plt\n","plt.style.use('ggplot')"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"Uu5db0IA6AMY"},"source":["#Generate plot\n","plt.title('k-NN Varying number of neighbors')\n","plt.plot(neighbors, test_accuracy, label='Testing Accuracy')\n","plt.plot(neighbors, train_accuracy, label='Training accuracy')\n","plt.legend()\n","plt.xlabel('Number of neighbors')\n","plt.ylabel('Accuracy')\n","plt.show()"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"ka82d7XU6XMu"},"source":["knn = KNeighborsClassifier(n_neighbors=7)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"57Q8uMC66b2n","executionInfo":{"elapsed":2444,"status":"ok","timestamp":1617627023251,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"deb820f5-501d-4a0a-f170-63920169a5f2"},"source":["#Fit the model\n","knn.fit(train_features,train_labels)"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["KNeighborsClassifier(algorithm='auto', leaf_size=30, metric='minkowski',\n","                     metric_params=None, n_jobs=None, n_neighbors=7, p=2,\n","                     weights='uniform')"]},"metadata":{"tags":[]},"execution_count":56}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"jeJ8XtHW6kb5","executionInfo":{"elapsed":97812,"status":"ok","timestamp":1617627121788,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"d9dcec62-dd7e-42c2-8f96-769f92feb8a2"},"source":["knn.score(test_features,test_labels)"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.8881578947368421"]},"metadata":{"tags":[]},"execution_count":57}]},{"cell_type":"code","metadata":{"id":"Da6HuDZLG6ou"},"source":["y_pred = knn.predict(test_features)\n","np.set_printoptions(threshold=np.inf)\n","y_pred"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"D4f66fCe7DI2","executionInfo":{"elapsed":94902,"status":"ok","timestamp":1617627941636,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"0cf0ec8c-5dfb-4ded-a36b-4ce0139ef988"},"source":["from sklearn.metrics import confusion_matrix\n","print(confusion_matrix(test_labels,y_pred))\n","from sklearn.metrics import classification_report\n","print(classification_report(test_labels,y_pred))"],"execution_count":null,"outputs":[{"output_type":"stream","text":["[[2081  275]\n"," [ 150 1294]]\n","              precision    recall  f1-score   support\n","\n","           0       0.93      0.88      0.91      2356\n","           1       0.82      0.90      0.86      1444\n","\n","    accuracy                           0.89      3800\n","   macro avg       0.88      0.89      0.88      3800\n","weighted avg       0.89      0.89      0.89      3800\n","\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"OyNTSlJyh830","executionInfo":{"elapsed":832,"status":"ok","timestamp":1617644864378,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"70d7375f-f467-4514-9e1e-721e1bf07793"},"source":["from sklearn.metrics import accuracy_score\n","print(accuracy_score(test_labels, y_pred))"],"execution_count":null,"outputs":[{"output_type":"stream","text":["0.8881578947368421\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"BIyj4Oah7s-J","executionInfo":{"elapsed":110342,"status":"ok","timestamp":1617627964302,"user":{"displayName":"SSBSE Admin","photoUrl":"","userId":"11167642343971864398"},"user_tz":-60},"outputId":"2adf76af-a47d-496e-d8d7-3a5143176537"},"source":["scores = cross_val_score(knn, test_features, test_labels, cv=5)\n","print(\"mean: {:.3f} (std: {:.3f})\".format(scores.mean(),\n","                                          scores.std()),\n","                                          end=\"\\n\\n\" )\n","#88%"],"execution_count":null,"outputs":[{"output_type":"stream","text":["mean: 0.910 (std: 0.010)\n","\n"],"name":"stdout"}]}]}